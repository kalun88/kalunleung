---
import PageLayout from "@/layouts/Base.astro";
import { getNavLink } from "@/lib/blog-helpers";
import { getAllTagsWithCounts } from "@/lib/notion/client";
import { getNotionColorToTailwindColor } from "@/lib/style-helpers";
import { slugify } from "@/utils";
import TagDescPopover from "@/components/TagDescPopover.astro";

const allTags = await getAllTagsWithCounts();

const meta = {
	title: "All Tags",
	description: "A list of all the topics I've written about in my posts",
	ogImage: "/og-image/tagsindex---index.png",
};
---

<PageLayout meta={meta}>
  <h1 class="title text-accent-2 mb-6">Tags</h1>
  <div class="flex flex-col gap-2 font-mono text-sm max-w-2xl">
    {
      allTags.map((tag) => (
        <div class="flex items-center justify-between border-b border-gray-200 dark:border-gray-700 pb-2">
          <a
            class="inline-flex items-center transition-opacity hover:opacity-80"
            href={getNavLink("/tags/" + slugify(tag.name) + "/")}
            title={`View posts with the tag: ${tag.name}`}
            aria-label={`View posts with the tag: ${tag.name}`}
            data-astro-prefetch
          >
            [{tag.name}]
          </a>
          <div class="flex items-center gap-2">
            <span class="text-xs text-gray-500">
              {tag.count}
            </span>
            {tag.description && (
              <TagDescPopover description={tag.description} />
            )}
          </div>
        </div>
      ))
    }
  </div>
</PageLayout>
